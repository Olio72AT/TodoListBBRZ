@model IEnumerable<TODOListAP03.Models.Authorization>

@{
    ViewBag.Title = "Index";
}

<h2>Index</h2>

<p>
    @{
        var myprofile = TODOListAP03.Controllers.AuthorizationController.UserListe.
            Where(z => z.UserId == TODOListAP03.Controllers.RessourcenController.whoami).FirstOrDefault();

        if (myprofile != null)
        {
            if (myprofile.Role == TODOListAP03.Models.roleType.admin)
            {
                @Html.ActionLink("Create New", "Create")

                }

            }
        }
    </p>
<table class="table">
    <tr>
        <th>
            @Html.DisplayNameFor(model => model.UserId)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Password)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.Role)
        </th>
        <th>
            @Html.DisplayNameFor(model => model.SessionId)
        </th>
        <th></th>
    </tr>

    @foreach (var item in Model)
    {

        @*
            Archive Flag implementation:
        *@

        if (myprofile != null)
        {
            if (myprofile.Role == TODOListAP03.Models.roleType.user)
            {
                if (item.UserId == TODOListAP03.Controllers.RessourcenController.whoami)
                {
                    if (item.Archive == true)
                    {

                        <tr>
                            <td>
                                @Html.DisplayFor(modelItem => item.UserId)
                            </td>
                            <td>
                                @Html.DisplayFor(modelItem => item.Password)
                            </td>
                            <th>
                                @Html.DisplayFor(modelitem => item.Role)
                            </th>
                            <td>
                                @Html.DisplayFor(modelItem => item.SessionId)
                            </td>
                            <td>

                                @*
                                    As proposed, we do not want to modify the password, so let's comment it
                                     @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                                *@

                                @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                                @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                            </td>
                        </tr>
                    }
                }
            }

            else
            {
                if (item.Archive == true)
                {

                    <tr>
                        <td>
                            @Html.DisplayFor(modelItem => item.UserId)
                        </td>
                        <td>
                            @Html.DisplayFor(modelItem => item.Password)
                        </td>
                        <th>
                            @Html.DisplayFor(modelitem => item.Role)
                        </th>
                        <td>
                            @Html.DisplayFor(modelItem => item.SessionId)
                        </td>
                        <td>

                            @*
                                As proposed, we do not want to modify the password, so let's comment it
                                 @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                            *@

                            @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                            @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                        </td>
                    </tr>
                }

            }

        }


        else
        {
            if (item.Archive == true)
            {

                <tr>
                    <td>
                        @Html.DisplayFor(modelItem => item.UserId)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Password)
                    </td>
                    <th>
                        @Html.DisplayFor(modelitem => item.Role)
                    </th>
                    <td>
                        @Html.DisplayFor(modelItem => item.SessionId)
                    </td>
                    <td>

                        @*
                            As proposed, we do not want to modify the password, so let's comment it
                             @Html.ActionLink("Edit", "Edit", new { id = item.Id }) |
                        *@

                        @Html.ActionLink("Details", "Details", new { id = item.Id }) |
                        @Html.ActionLink("Delete", "Delete", new { id = item.Id })
                    </td>
                </tr>
            }
        }
     }
</table>

<p> DO NOT FORGET TO DELETE THE ORIGIN USERS, after you have created new ADMINs or USERs ;)</p>
